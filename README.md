# Point App Hiring Exercise

This exercise is a GraphQL API written in Node.js attached to a PostgreSQL database.

## Getting Started

After cloning down the repo and installing the necessary dependencies you can run the project locally on port 3000

```bash
npm clone <REPO_URL>
cd point-app
npm install  // installs dependencies -> generates node_modules folder
npm run dev  // invokes nodemon in watch mode for development
```

## ENV Variables

By default the app will attempt to connect to a deployed Postgres instance provided by Heroku. However local DB instances are also supported via two environment variables DEV_MODE, and DATABASE_URL.

If you'd like to run the db locally then export DEV_MODE=true and modify the DATABASE_URL to point to your local db.
example

```bash
export DEV_MODE=true # runs server locally
export POINT_APP_POSTGRES_DB=false # uses deployed version of PostgreS DB
export DATABASE_URL=pg://<user>:<pass>@<host>:<port>/<db>?ssl=true
# The following vars are related to the Auth0 SSO package, and are configurable at manage.auth0.com
export CLIENT_ID=<AUTH0 CONFIG>
export ISSUER_BASE_URL=<AUTH0 CONFIG>
export POINT_APP_SECRET=<AUTH0 CONFIG>
```

## Auth0

As mentioned in the Env Variables section, the Auth is being handled by a third party Auth0. If you choose to clone down the project, you can create an account with Auth0 to generate your our clientId, issuerBaseUrl, and secret respectively. These variables should never be commited into your version manager and should be injected via env vars.

## Example Mutations

```
mutation {
 createPost(input:{userId:"2", body:"emails are so yesterday", title:"silly slack"}){
   title
   body
  }
}
mutation {
  createUser(input:{password:"superTopSecret", email:"teslaturbine@protonmail.com"}){
    password
    email
  }
}
```

## SSL Issues

If you are encountering SSL issues in connecting to the Heroku DB, an additional environment variable may be required to access the datastore. This is a work around for a self-signed certificate generated by the pg module.

```bash
export NODE_TLS_REJECT_UNAUTHORIZED=0
```

## Heroku

This application is currently deployed to Heroku and is available at the link below.
https://pointappgraphql.herokuapp.com/

available endpoints include...
GET https://pointappgraphql.herokuapp.com/graphql
GET https://pointappgraphql.herokuapp.com/login
GET https://pointappgraphql.herokuapp.com/logout
GET https://pointappgraphql.herokuapp.com/callback

Users should be redirected to the /graphql endpoint upon successful authentication

## Next steps

Given more time this API would likely grow to include additional libraries and functionality.
Such efforts would likely include additional Querys and Mutations, specifically regarding uploading media, adding friend relationships. Additionally a content security policy library (CSP), such as helmet-csp, would improve overall app security. Further work on error handling and logging would also be nice additions to the API.
